<%= form_for @recipe, html: {class: "form-horizontal", role: "form"} do |f| %>
  <% if @recipe.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@recipe.errors.count, "error") %> prohibited this recipe from being saved:</h2>

      <ul>
      <% @recipe.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="form-group">
    <%= f.label :name, class: "col-sm-2 control-label" %>
    <div class="col-sm-10">
      <%= f.text_field :name, autofocus: true, class: "form-control" %>
    </div>
  </div>

  <div class="form-group">
    <%= f.label :ingredients, class: "col-sm-2 control-label" %>
    <div class="col-sm-10">
      <%= f.text_area :ingredients, class: "form-control" %>
    </div>
  </div>

  <div class="form-group">
    <%= f.label :instructions, class: "col-sm-2 control-label" %>
    <div class="col-sm-10">
      <%= f.text_area :instructions, class: "form-control" %>
    </div>
  </div>

  <div class="form-group">
    <%= f.label :tags, class: "col-sm-2 control-label" %>
    <div class="col-sm-10">
      <%= f.text_field :tags, value: @recipe.tags.join(","), class: "form-control" %>
    </div>
  </div>

  <div class="form-group">
    <%= f.label :source, class: "col-sm-2 control-label" %>
    <div class="col-sm-10">
      <%= f.text_field :source, value: @recipe.source, class: "form-control" %>
    </div>
  </div>

  <div class="form-group rating-effort">
    <%= f.label :effort, "Difficulty", class: "col-sm-2 control-label" %>
    <div class="col-sm-10">
      <%= f.number_field :effort, class: "rating", "data-min" => 1, "data-max" => 3, "data-clearable" => "Clear" %>
    </div>
  </div>

  <div class="form-group rating-cost">
    <%= f.label :cost, class: "col-sm-2 control-label" %>
    <div class="col-sm-10">
      <%= f.number_field :cost, class: "rating", "data-min" => 1, "data-max" => 3, "data-clearable" => "Clear" %>
    </div>
  </div>

  <div class="form-group">
    <br/><br/>
    <div class="col-sm-10 col-sm-offset-2">
      <button type="submit" class="btn btn-primary"><%= @recipe.persisted? ? "Update" : "Create" %> Recipe</button>

      <% if @recipe.persisted? %>
        <%= link_to "Destroy", @recipe, method: :delete, data: { confirm: "Are you sure?" }, class: "btn btn-danger" %>
      <% end %>
    </div>
  </div>
<% end %>


<script type="text/javascript">
  $(function() {
    var tags = new Bloodhound({
      datumTokenizer: Bloodhound.tokenizers.whitespace,
      queryTokenizer: Bloodhound.tokenizers.whitespace,
      local: <%=raw @tags.to_json %>
    });

    $('#recipe_tags').tagsinput({
      typeaheadjs: {
        source: tags
      }
    });
  });
</script>
